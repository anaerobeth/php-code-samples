$(function(){LayoutSetup();$gp.links.layout_id=function(a,b){function d(){e.hide();$("body").off(".layout_id")}a.preventDefault();var c=$(this).offset();$("#current_color").css("background-color",b);var e=$("#layout_ident").show().css({left:c.left+20,top:c.top}).appendTo("#gp_admin_html"),f=e.find("form").get(0);f&&$(this).find("input").each(function(a,b){f[b.name]&&(f[b.name].value=b.value)});e.find("a.color").off("click").on("click",function(){var a=$(this).data("arg");$("#current_color").css("background-color",
a);f.color.value=a});e.find("input.close_color_dialog").off("click").on("click",function(){d()});$("body").on("click.layout_id",function(a){$(a.target).closest("#layout_ident").length||d()}).on("keydown.layout_id",function(a){27===a.keyCode&&(a.preventDefault(),d())})};$(document).delegate(".draggable_element",{mouseenter:function(){var a=$(this);if(!a.hasClass("target")){a.addClass("hover");a.find("div").stop(!0,!0).fadeIn();a.stop(!0).fadeTo("200",1);var b=a.height();a.data("ph",b);a.height("auto").height()<
b&&a.height(b)}},mouseleave:function(){var a=$(this).removeClass("hover").stop(!0).fadeTo("slow",0.5);a.find("div").stop(!0,!0).fadeOut();var b=a.data("ph");0<parseInt(b)&&a.height(b)}});$(".theme_select select").change(function(){""!=this.value&&(window.location="layout"==this.name?this.form.action+"/"+this.value:this.form.action+"?cmd=preview&theme="+this.value)})});
function LayoutSetup(){$("#theme_toolbar").length&&$("body").addClass("edit_layout");if("undefined"!=typeof gpLayouts){$("a.ExtraEditLink").detach();$(".editable_area").removeClass("editable_area");var a=$(".filetype-text");a.offset();a.width();var b=$('<div class="draggable_droparea" id="theme_content_drop"></div>').appendTo("#gp_admin_html"),d=$(".gp_inner_links");$(".gp_output_area").each(function(a,c){var h,j,g=$(c);h=$gp.Coords(g);j=d.eq(a);if(0<j.length)$('<div class="draggable_element" style="position:absolute;height:5px;width:5px;"></div>').appendTo(b).append(j).fadeTo("fast",
0.5).height(h.h-3).width(h.w-3).on("gp_position",function(){var a=$gp.Coords(g);20>a.h&&(g.height(20),a.h=20);20>a.w&&(g.width(20),a.w=20);$(this).css({top:a.top,left:a.left})})});var c=$(".draggable_element");c.trigger("gp_position");window.setInterval(function(){c.trigger("gp_position")},2E3)}}
$gp.response.EditCSS=function(){var a=$("#gp_layout_css"),b=$("#gp_layout_style"),d=$("#gp_layout_style").html(),c=window.setInterval(function(){a.is(":visible")?b.html(a.val()):(b.html(d),window.clearInterval(c))},1E3)};